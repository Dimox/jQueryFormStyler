/* jQuery Form Styler v1.7.7 | (c) Dimox | https://github.com/Dimox/jQueryFormStyler */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";function d(b,d){this.element=b,this.options=a.extend({},c,d),this.init()}function e(c){if(!a(c.target).parents().hasClass("jq-selectbox")&&"OPTION"!=c.target.nodeName&&a("div.jq-selectbox.opened").length){var d=a("div.jq-selectbox.opened"),e=a("div.jq-selectbox__search input",d),f=a("div.jq-selectbox__dropdown",d),g=d.find("select").data("_"+b).options;g.onSelectClosed.call(d),e.length&&e.val("").keyup(),f.hide().find("li.sel").addClass("selected"),d.removeClass("focused opened dropup dropdown")}}var b="styler",c={idSuffix:"-styler",filePlaceholder:"Файл не выбран",fileBrowse:"Обзор...",fileNumber:"Выбрано файлов: %s",selectPlaceholder:"Выберите...",selectSearch:!1,selectSearchLimit:10,selectSearchNotFound:"Совпадений не найдено",selectSearchPlaceholder:"Поиск...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:!0,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};d.prototype={init:function(){function g(){void 0!==b.attr("id")&&""!==b.attr("id")&&(this.id=b.attr("id")+c.idSuffix),this.title=b.attr("title"),this.classes=b.attr("class"),this.data=b.data()}var b=a(this.element),c=this.options,d=!(!navigator.userAgent.match(/(iPad|iPhone|iPod)/i)||navigator.userAgent.match(/(Windows\sPhone)/i)),f=!(!navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/(Windows\sPhone)/i));if(b.is(":checkbox")){var h=function(){var c=new g,d=a('<div class="jq-checkbox"><div class="jq-checkbox__div"></div></div>').attr({id:c.id,title:c.title}).addClass(c.classes).data(c.data);b.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(d).prependTo(d),d.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"}),b.is(":checked")&&d.addClass("checked"),b.is(":disabled")&&d.addClass("disabled"),d.click(function(a){a.preventDefault(),d.is(".disabled")||(b.is(":checked")?(b.prop("checked",!1),d.removeClass("checked")):(b.prop("checked",!0),d.addClass("checked")),b.focus().change())}),b.closest("label").add('label[for="'+b.attr("id")+'"]').on("click.styler",function(b){a(b.target).is("a")||a(b.target).closest(d).length||(d.triggerHandler("click"),b.preventDefault())}),b.on("change.styler",function(){b.is(":checked")?d.addClass("checked"):d.removeClass("checked")}).on("keydown.styler",function(a){32==a.which&&d.click()}).on("focus.styler",function(){d.is(".disabled")||d.addClass("focused")}).on("blur.styler",function(){d.removeClass("focused")})};h(),b.on("refresh",function(){b.closest("label").add('label[for="'+b.attr("id")+'"]').off(".styler"),b.off(".styler").parent().before(b).remove(),h()})}else if(b.is(":radio")){var i=function(){var c=new g,d=a('<div class="jq-radio"><div class="jq-radio__div"></div></div>').attr({id:c.id,title:c.title}).addClass(c.classes).data(c.data);b.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(d).prependTo(d),d.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"}),b.is(":checked")&&d.addClass("checked"),b.is(":disabled")&&d.addClass("disabled"),a.fn.commonParents=function(){var b=this;return b.first().parents().filter(function(){return a(this).find(b).length===b.length})},a.fn.commonParent=function(){return a(this).commonParents().first()},d.click(function(c){if(c.preventDefault(),!d.is(".disabled")){var e=a('input[name="'+b.attr("name")+'"]');e.commonParent().find(e).prop("checked",!1).parent().removeClass("checked"),b.prop("checked",!0).parent().addClass("checked"),b.focus().change()}}),b.closest("label").add('label[for="'+b.attr("id")+'"]').on("click.styler",function(b){a(b.target).is("a")||a(b.target).closest(d).length||(d.triggerHandler("click"),b.preventDefault())}),b.on("change.styler",function(){b.parent().addClass("checked")}).on("focus.styler",function(){d.is(".disabled")||d.addClass("focused")}).on("blur.styler",function(){d.removeClass("focused")})};i(),b.on("refresh",function(){b.closest("label").add('label[for="'+b.attr("id")+'"]').off(".styler"),b.off(".styler").parent().before(b).remove(),i()})}else if(b.is(":file")){b.css({position:"absolute",top:0,right:0,margin:0,padding:0,opacity:0,fontSize:"100px"});var j=function(){var d=new g,e=b.data("placeholder");void 0===e&&(e=c.filePlaceholder);var f=b.data("browse");void 0!==f&&""!==f||(f=c.fileBrowse);var h=a('<div class="jq-file"><div class="jq-file__name">'+e+'</div><div class="jq-file__browse">'+f+"</div></div>").css({display:"inline-block",position:"relative",overflow:"hidden"}).attr({id:d.id,title:d.title}).addClass(d.classes).data(d.data);b.after(h).appendTo(h),b.is(":disabled")&&h.addClass("disabled"),b.on("change.styler",function(){var d=b.val(),f=a("div.jq-file__name",h);if(b.is("[multiple]")){d="";var g=b[0].files.length;if(g>0){var i=b.data("number");void 0===i&&(i=c.fileNumber),i=i.replace("%s",g),d=i}}f.text(d.replace(/.+[\\\/]/,"")),""===d?(f.text(e),h.removeClass("changed")):h.addClass("changed")}).on("focus.styler",function(){h.addClass("focused")}).on("blur.styler",function(){h.removeClass("focused")}).on("click.styler",function(){h.removeClass("focused")})};j(),b.on("refresh",function(){b.off(".styler").parent().before(b).remove(),j()})}else if(b.is('input[type="number"]')){var k=function(){var c=new g,d=a('<div class="jq-number"><div class="jq-number__spin minus"></div><div class="jq-number__spin plus"></div></div>').attr({id:c.id,title:c.title}).addClass(c.classes).data(c.data);b.after(d).prependTo(d).wrap('<div class="jq-number__field"></div>'),b.is(":disabled")&&d.addClass("disabled");var e,f,h,i=null,j=null;void 0!==b.attr("min")&&(e=b.attr("min")),void 0!==b.attr("max")&&(f=b.attr("max")),h=void 0!==b.attr("step")&&a.isNumeric(b.attr("step"))?Number(b.attr("step")):Number(1);var k=function(c){var g,d=b.val();a.isNumeric(d)||(d=0,b.val("0")),c.is(".minus")?g=Number(d)-h:c.is(".plus")&&(g=Number(d)+h);var i=(h.toString().split(".")[1]||[]).length;if(i>0){for(var j="1";j.length<=i;)j+="0";g=Math.round(g*j)/j}a.isNumeric(e)&&a.isNumeric(f)?g>=e&&g<=f&&b.val(g):a.isNumeric(e)&&!a.isNumeric(f)?g>=e&&b.val(g):!a.isNumeric(e)&&a.isNumeric(f)?g<=f&&b.val(g):b.val(g)};d.is(".disabled")||(d.on("mousedown","div.jq-number__spin",function(){var b=a(this);k(b),i=setTimeout(function(){j=setInterval(function(){k(b)},40)},350)}).on("mouseup mouseout","div.jq-number__spin",function(){clearTimeout(i),clearInterval(j)}).on("mouseup","div.jq-number__spin",function(){b.change()}),b.on("focus.styler",function(){d.addClass("focused")}).on("blur.styler",function(){d.removeClass("focused")}))};k(),b.on("refresh",function(){b.off(".styler").closest(".jq-number").before(b).remove(),k()})}else if(b.is("select")){var l=function(){function h(b){b.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(b){var c=null;"mousewheel"==b.type?c=b.originalEvent.wheelDelta*-1:"DOMMouseScroll"==b.type&&(c=40*b.originalEvent.detail),c&&(b.stopPropagation(),b.preventDefault(),a(this).scrollTop(c+a(this).scrollTop()))})}function k(){for(var a=0;a<i.length;a++){var b=i.eq(a),d="",e="",f="",g="",h="",k="",l="",m="",n="",o="disabled",p="selected sel disabled";b.prop("selected")&&(e="selected sel"),b.is(":disabled")&&(e=o),b.is(":selected:disabled")&&(e=p),void 0!==b.attr("id")&&""!==b.attr("id")&&(g=' id="'+b.attr("id")+c.idSuffix+'"'),void 0!==b.attr("title")&&""!==i.attr("title")&&(h=' title="'+b.attr("title")+'"'),void 0!==b.attr("class")&&(l=" "+b.attr("class"),n=' data-jqfs-class="'+b.attr("class")+'"');var q=b.data();for(var r in q)""!==q[r]&&(k+=" data-"+r+'="'+q[r]+'"');e+l!==""&&(f=' class="'+e+l+'"'),d="<li"+n+k+f+h+g+">"+b.html()+"</li>",b.parent().is("optgroup")&&(void 0!==b.parent().attr("class")&&(m=" "+b.parent().attr("class")),d="<li"+n+k+' class="'+e+l+" option"+m+'"'+h+g+">"+b.html()+"</li>",b.is(":first-child")&&(d='<li class="optgroup'+m+'">'+b.parent().attr("label")+"</li>"+d)),j+=d}}function l(){var f=new g,l="",m=b.data("placeholder"),n=b.data("search"),o=b.data("search-limit"),p=b.data("search-not-found"),q=b.data("search-placeholder"),r=b.data("z-index"),s=b.data("smart-positioning");void 0===m&&(m=c.selectPlaceholder),void 0!==n&&""!==n||(n=c.selectSearch),void 0!==o&&""!==o||(o=c.selectSearchLimit),void 0!==p&&""!==p||(p=c.selectSearchNotFound),void 0===q&&(q=c.selectSearchPlaceholder),void 0!==r&&""!==r||(r=c.singleSelectzIndex),void 0!==s&&""!==s||(s=c.selectSmartPositioning);var t=a('<div class="jq-selectbox jqselect"><div class="jq-selectbox__select" style="position: relative"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>').css({display:"inline-block",position:"relative",zIndex:r}).attr({id:f.id,title:f.title}).addClass(f.classes).data(f.data);b.css({margin:0,padding:0}).after(t).prependTo(t);var u=a("div.jq-selectbox__select",t),v=a("div.jq-selectbox__select-text",t),w=i.filter(":selected");k(),n&&(l='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+q+'"></div><div class="jq-selectbox__not-found">'+p+"</div>");var x=a('<div class="jq-selectbox__dropdown" style="position: absolute">'+l+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+j+"</ul></div>");t.append(x);var y=a("ul",x),z=a("li",x),A=a("input",x),B=a("div.jq-selectbox__not-found",x).hide();z.length<o&&A.parent().hide(),""===i.first().text()&&i.first().is(":selected")?v.text(m).addClass("placeholder"):v.text(w.text());var C=0,D=0;if(z.css({display:"inline-block"}),z.each(function(){var b=a(this);b.innerWidth()>C&&(C=b.innerWidth(),D=b.width())}),z.css({display:""}),v.is(".placeholder")&&v.width()>C)v.width(v.width());else{var E=t.clone().appendTo("body").width("auto"),F=E.outerWidth();E.remove(),F==t.outerWidth()&&v.width(D)}C>t.width()&&x.width(C),""===i.first().text()&&""!==b.data("placeholder")&&z.first().hide(),b.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var G=t.outerHeight(!0),H=A.parent().outerHeight(!0)||0,I=y.css("max-height"),J=z.filter(".selected");J.length<1&&z.first().addClass("selected sel"),void 0===z.data("li-height")&&z.data("li-height",z.outerHeight());var K=x.css("top");if("auto"==x.css("left")&&x.css({left:0}),"auto"==x.css("top")&&(x.css({top:G}),K=G),x.hide(),J.length&&(i.first().text()!=w.text()&&t.addClass("changed"),t.data("jqfs-class",J.data("jqfs-class")),t.addClass(J.data("jqfs-class"))),b.is(":disabled"))return t.addClass("disabled"),!1;u.click(function(){if(a("div.jq-selectbox").filter(".opened").length&&c.onSelectClosed.call(a("div.jq-selectbox").filter(".opened")),b.focus(),!d){var e=a(window),f=z.data("li-height"),g=t.offset().top,j=e.height()-G-(g-e.scrollTop()),k=b.data("visible-options");void 0!==k&&""!==k||(k=c.selectVisibleOptions);var l=5*f,m=f*k;k>0&&k<6&&(l=m),0===k&&(m="auto");var n=function(){x.height("auto").css({bottom:"auto",top:K});var a=function(){y.css("max-height",Math.floor((j-20-H)/f)*f)};a(),y.css("max-height",m),"none"!=I&&y.css("max-height",I),j<x.outerHeight()+20&&a()},o=function(){x.height("auto").css({top:"auto",bottom:K});var a=function(){y.css("max-height",Math.floor((g-e.scrollTop()-20-H)/f)*f)};a(),y.css("max-height",m),"none"!=I&&y.css("max-height",I),g-e.scrollTop()-20<x.outerHeight()+20&&a()};s===!0||1===s?j>l+H+20?(n(),t.removeClass("dropup").addClass("dropdown")):(o(),t.removeClass("dropdown").addClass("dropup")):s!==!1&&0!==s||j>l+H+20&&(n(),t.removeClass("dropup").addClass("dropdown")),t.offset().left+x.outerWidth()>e.width()&&x.css({left:"auto",right:0}),a("div.jqselect").css({zIndex:r-1}).removeClass("opened"),t.css({zIndex:r}),x.is(":hidden")?(a("div.jq-selectbox__dropdown:visible").hide(),x.show(),t.addClass("opened focused"),c.onSelectOpened.call(t)):(x.hide(),t.removeClass("opened dropup dropdown"),a("div.jq-selectbox").filter(".opened").length&&c.onSelectClosed.call(t)),A.length&&(A.val("").keyup(),B.hide(),A.keyup(function(){var c=a(this).val();z.each(function(){a(this).html().match(new RegExp(".*?"+c+".*?","i"))?a(this).show():a(this).hide()}),""===i.first().text()&&""!==b.data("placeholder")&&z.first().hide(),z.filter(":visible").length<1?B.show():B.hide()})),z.filter(".selected").length&&(""===b.val()?y.scrollTop(0):(y.innerHeight()/f%2!==0&&(f/=2),y.scrollTop(y.scrollTop()+z.filter(".selected").position().top-y.innerHeight()/2+f))),h(y)}}),z.hover(function(){a(this).siblings().removeClass("selected")});var L=z.filter(".selected").text();z.filter(":not(.disabled):not(.optgroup)").click(function(){b.focus();var d=a(this),e=d.text();if(!d.is(".selected")){var f=d.index();f-=d.prevAll(".optgroup").length,d.addClass("selected sel").siblings().removeClass("selected sel"),i.prop("selected",!1).eq(f).prop("selected",!0),L=e,v.text(e),t.data("jqfs-class")&&t.removeClass(t.data("jqfs-class")),t.data("jqfs-class",d.data("jqfs-class")),t.addClass(d.data("jqfs-class")),b.change()}x.hide(),t.removeClass("opened dropup dropdown"),c.onSelectClosed.call(t)}),x.mouseout(function(){a("li.sel",x).addClass("selected")}),b.on("change.styler",function(){v.text(i.filter(":selected").text()).removeClass("placeholder"),z.removeClass("selected sel").not(".optgroup").eq(b[0].selectedIndex).addClass("selected sel"),i.first().text()!=z.filter(".selected").text()?t.addClass("changed"):t.removeClass("changed")}).on("focus.styler",function(){t.addClass("focused"),a("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").hide()}).on("blur.styler",function(){t.removeClass("focused")}).on("keydown.styler keyup.styler",function(a){var d=z.data("li-height");""===b.val()?v.text(m).addClass("placeholder"):v.text(i.filter(":selected").text()),z.removeClass("selected sel").not(".optgroup").eq(b[0].selectedIndex).addClass("selected sel"),38!=a.which&&37!=a.which&&33!=a.which&&36!=a.which||(""===b.val()?y.scrollTop(0):y.scrollTop(y.scrollTop()+z.filter(".selected").position().top)),40!=a.which&&39!=a.which&&34!=a.which&&35!=a.which||y.scrollTop(y.scrollTop()+z.filter(".selected").position().top-y.innerHeight()+d),13==a.which&&(a.preventDefault(),x.hide(),t.removeClass("opened dropup dropdown"),c.onSelectClosed.call(t))}).on("keydown.styler",function(a){32==a.which&&(a.preventDefault(),u.click())}),e.registered||(a(document).on("click",e),e.registered=!0)}function m(){var c=new g,d=a('<div class="jq-select-multiple jqselect"></div>').css({display:"inline-block",position:"relative"}).attr({id:c.id,title:c.title}).addClass(c.classes).data(c.data);b.css({margin:0,padding:0}).after(d),k(),d.append("<ul>"+j+"</ul>");var e=a("ul",d).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),f=a("li",d).attr("unselectable","on"),l=b.attr("size"),m=e.outerHeight(),n=f.outerHeight();void 0!==l&&l>0?e.css({height:n*l}):e.css({height:4*n}),m>d.height()&&(e.css("overflowY","scroll"),h(e),f.filter(".selected").length&&e.scrollTop(e.scrollTop()+f.filter(".selected").position().top)),b.prependTo(d).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0}),b.is(":disabled")?(d.addClass("disabled"),i.each(function(){a(this).is(":selected")&&f.eq(a(this).index()).addClass("selected")})):(f.filter(":not(.disabled):not(.optgroup)").click(function(c){b.focus();var d=a(this);if(c.ctrlKey||c.metaKey||d.addClass("selected"),c.shiftKey||d.addClass("first"),c.ctrlKey||c.metaKey||c.shiftKey||d.siblings().removeClass("selected first"),(c.ctrlKey||c.metaKey)&&(d.is(".selected")?d.removeClass("selected first"):d.addClass("selected first"),d.siblings().removeClass("first")),c.shiftKey){var e=!1,g=!1;d.siblings().removeClass("selected").siblings(".first").addClass("selected"),d.prevAll().each(function(){a(this).is(".first")&&(e=!0)}),d.nextAll().each(function(){a(this).is(".first")&&(g=!0)}),e&&d.prevAll().each(function(){return!a(this).is(".selected")&&void a(this).not(".disabled, .optgroup").addClass("selected")}),g&&d.nextAll().each(function(){return!a(this).is(".selected")&&void a(this).not(".disabled, .optgroup").addClass("selected")}),1==f.filter(".selected").length&&d.addClass("first")}i.prop("selected",!1),f.filter(".selected").each(function(){var b=a(this),c=b.index();b.is(".option")&&(c-=b.prevAll(".optgroup").length),i.eq(c).prop("selected",!0)}),b.change()}),i.each(function(b){a(this).data("optionIndex",b)}),b.on("change.styler",function(){f.removeClass("selected");var b=[];i.filter(":selected").each(function(){b.push(a(this).data("optionIndex"))}),f.not(".optgroup").filter(function(c){return a.inArray(c,b)>-1}).addClass("selected")}).on("focus.styler",function(){d.addClass("focused")}).on("blur.styler",function(){d.removeClass("focused")}),m>d.height()&&b.on("keydown.styler",function(a){38!=a.which&&37!=a.which&&33!=a.which||e.scrollTop(e.scrollTop()+f.filter(".selected").position().top-n),40!=a.which&&39!=a.which&&34!=a.which||e.scrollTop(e.scrollTop()+f.filter(".selected:last").position().top-e.innerHeight()+2*n)}))}var i=a("option",b),j="";if(b.is("[multiple]")){if(f||d)return;m()}else l()};l(),b.on("refresh",function(){b.off(".styler").parent().before(b).remove(),l()})}else b.is(":reset")&&b.on("click",function(){setTimeout(function(){b.closest("form").find("input, select").trigger("refresh")},1)})},destroy:function(){var c=a(this.element);c.is(":checkbox")||c.is(":radio")?(c.removeData("_"+b).off(".styler refresh").removeAttr("style").parent().before(c).remove(),c.closest("label").add('label[for="'+c.attr("id")+'"]').off(".styler")):c.is('input[type="number"]')?c.removeData("_"+b).off(".styler refresh").closest(".jq-number").before(c).remove():(c.is(":file")||c.is("select"))&&c.removeData("_"+b).off(".styler refresh").removeAttr("style").parent().before(c).remove()}},a.fn[b]=function(c){var e=arguments;if(void 0===c||"object"==typeof c)return this.each(function(){a.data(this,"_"+b)||a.data(this,"_"+b,new d(this,c))}).promise().done(function(){var c=a(this[0]).data("_"+b);c&&c.options.onFormStyled.call()}),this;if("string"==typeof c&&"_"!==c[0]&&"init"!==c){var f;return this.each(function(){var g=a.data(this,"_"+b);g instanceof d&&"function"==typeof g[c]&&(f=g[c].apply(g,Array.prototype.slice.call(e,1)))}),void 0!==f?f:this}},e.registered=!1});
