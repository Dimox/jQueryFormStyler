(function(e){e.fn.styler=function(f){f=e.extend({idSuffix:"-styler",filePlaceholder:"\u0424\u0430\u0439\u043b \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d",browseText:"\u041e\u0431\u0437\u043e\u0440...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:!0,selectSearch:!0,selectSearchPlaceholder:"\u041f\u043e\u0438\u0441\u043a...",selectSearchLimit:10},f);return this.each(function(){function r(){var e="",s="",b="",n="";void 0!==a.attr("id")&&""!=a.attr("id")&&(e=' id="'+a.attr("id")+
f.idSuffix+'"');void 0!==a.attr("title")&&""!=a.attr("title")&&(s=' title="'+a.attr("title")+'"');void 0!==a.attr("class")&&""!=a.attr("class")&&(b=" "+a.attr("class"));var r=a.data(),h;for(h in r)""!=r[h]&&(n+=" data-"+h+'="'+r[h]+'"');this.id=e+n;this.title=s;this.classes=b}var a=e(this);a.is(":checkbox")?a.each(function(){if(1>a.parent("div.jq-checkbox").length){var f=function(){var f=new r,b=e("<div"+f.id+' class="jq-checkbox'+f.classes+'"'+f.title+'><div class="jq-checkbox__div"></div></div>');
a.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(b).prependTo(b);b.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"});a.is(":checked")&&b.addClass("checked");a.is(":disabled")&&b.addClass("disabled");b.click(function(){b.is(".disabled")||(a.is(":checked")?(a.prop("checked",!1),b.removeClass("checked")):(a.prop("checked",
!0),b.addClass("checked")),a.change());return!1});a.closest("label").add('label[for="'+a.attr("id")+'"]').click(function(a){b.click();a.preventDefault()});a.change(function(){a.is(":checked")?b.addClass("checked"):b.removeClass("checked")}).keydown(function(a){13!=a.which&&32!=a.which||b.click()}).focus(function(){b.is(".disabled")||b.addClass("focused")}).blur(function(){b.removeClass("focused")})};f();a.on("refresh",function(){a.parent().before(a).remove();f()})}}):a.is(":radio")?a.each(function(){if(1>
a.parent("div.jq-radio").length){var f=function(){var f=new r,b=e("<div"+f.id+' class="jq-radio'+f.classes+'"'+f.title+'><div class="jq-radio__div"></div></div>');a.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(b).prependTo(b);b.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"});a.is(":checked")&&b.addClass("checked");a.is(":disabled")&&
b.addClass("disabled");b.click(function(){b.is(".disabled")||(b.closest("form").find('input[name="'+a.attr("name")+'"]').prop("checked",!1).parent().removeClass("checked"),a.prop("checked",!0).parent().addClass("checked"),a.change());return!1});a.closest("label").add('label[for="'+a.attr("id")+'"]').click(function(a){b.click();a.preventDefault()});a.change(function(){a.parent().addClass("checked")}).focus(function(){b.is(".disabled")||b.addClass("focused")}).blur(function(){b.removeClass("focused")})};
f();a.on("refresh",function(){a.parent().before(a).remove();f()})}}):a.is(":file")?a.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:0,margin:0,padding:0}).each(function(){if(1>a.parent("div.jq-file").length){var q=function(){var s=new r,b=e("<div"+s.id+' class="jq-file'+s.classes+'"'+s.title+' style="display: inline-block; position: relative; overflow: hidden"></div>'),n=e('<div class="jq-file__name">'+f.filePlaceholder+"</div>").appendTo(b);e('<div class="jq-file__browse">'+
f.browseText+"</div>").appendTo(b);a.after(b);b.append(a);a.is(":disabled")&&b.addClass("disabled");a.change(function(){n.text(a.val().replace(/.+[\\\/]/,""))}).focus(function(){b.addClass("focused")}).blur(function(){b.removeClass("focused")}).click(function(){b.removeClass("focused")})};q();a.on("refresh",function(){a.parent().before(a).remove();q()})}}):a.is("select")?a.each(function(){if(1>a.next("div.jqselect").length){var q=function(){function s(a){a.unbind("mousewheel DOMMouseScroll").bind("mousewheel DOMMouseScroll",
function(a){var b=null;"mousewheel"==a.type?b=-1*a.originalEvent.wheelDelta:"DOMMouseScroll"==a.type&&(b=40*a.originalEvent.detail);b&&(a.preventDefault(),e(this).scrollTop(b+e(this).scrollTop()))})}function b(){f.selectSearch&&h.length>f.selectSearchLimit&&(v='<li class="'+w+'"><input class="'+x+' styler search-box" style="width: 100%"  type="search" placeholder="'+f.selectSearchPlaceholder+'" autofocus></li>');i=0;for(len=h.length;i<len;i++){var a="",d="",e=a="",b="",c="";h.eq(i).prop("selected")&&
(d="selected sel");h.eq(i).is(":disabled")&&(d="disabled");h.eq(i).is(":selected:disabled")&&(d="selected sel disabled");void 0!==h.eq(i).attr("class")&&(e=" "+h.eq(i).attr("class"),c=' data-jqfs-class="'+h.eq(i).attr("class")+'"');var g=h.eq(i).data(),l;for(l in g)""!=g[l]&&(a+=" data-"+l+'="'+g[l]+'"');a="<li"+c+a+' class="'+d+e+'">'+h.eq(i).text()+"</li>";h.eq(i).parent().is("optgroup")&&(void 0!==h.eq(i).parent().attr("class")&&(b=" "+h.eq(i).parent().attr("class")),a="<li"+c+' class="'+d+e+" option"+
b+'">'+h.eq(i).text()+"</li>",h.eq(i).is(":first-child")&&(a='<li class="optgroup'+b+'">'+h.eq(i).parent().attr("label")+"</li>"+a));v+=a}}function n(){var m=new r,d=e("<div"+m.id+' class="jq-selectbox jqselect'+m.classes+'" style="display: inline-block; position: relative; z-index:'+f.singleSelectzIndex+'"><div class="jq-selectbox__select"'+m.title+'><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>');
a.css({margin:0,padding:0}).wrap('<div class="jq-selectbox-wrapper" style="display: inline-block; position: relative;"></div>').after(d);var m=a.clone().appendTo("body"),u=m.width();m.remove();u!=a.width()&&a.parent().css("display","block");var m=e("div.jq-selectbox__select",d),k=e("div.jq-selectbox__select-text",d),u=h.filter(":selected");u.length?k.text(u.text()):k.text(h.first().text());b();var c=e('<div class="jq-selectbox__dropdown" style="position: absolute; overflow: auto; overflow-x: hidden"><ul style="list-style: none">'+
v+"</ul></div>");d.append(c);var g=e("li",c),l=0;g.each(function(){e(this).css({display:"inline-block","white-space":"nowrap"});e(this).width()>l&&(l=e(this).width());e(this).css({display:"block","white-space":"normal"})});d.width(a.outerWidth());l>c.width()&&c.width(l+c.width()-g.width());a.css({position:"absolute",opacity:0,height:d.outerHeight()});var p=g.filter(".selected");1>p.length&&g.first().addClass("selected sel");var q=d.outerHeight();"auto"==c.css("left")&&c.css({left:0});"auto"==c.css("top")&&
c.css({top:q});var t=g.outerHeight(),n=c.css("top");c.hide();p.length&&(h.first().text()!=u.text()&&d.addClass("changed"),d.data("jqfs-class",p.data("jqfs-class")),d.addClass(p.data("jqfs-class")));if(a.is(":disabled"))return d.addClass("disabled"),!1;var y,z=g.children("."+x+"");m.click(function(){a.focus();if(!navigator.userAgent.match(/(iPad|iPhone|iPod)/g)){z.val("");g.show();if(f.selectSmartPositioning){var b=e(window),h=d.offset().top,l=b.height()-q-(h-b.scrollTop()),p=f.selectVisibleOptions,
m=6*t,k=t*p;0<p&&6>p&&(m=k);0>l||l<m?(c.height("auto").css({top:"auto",bottom:n}),c.outerHeight()>h-b.scrollTop()-20&&(c.height(Math.floor((h-b.scrollTop()-20)/t)*t),0<p&&6>p?c.height()>m&&c.height(m):6<p&&c.height()>k&&c.height(k))):l>m&&(c.height("auto").css({bottom:"auto",top:n}),c.outerHeight()>l-20&&(c.height(Math.floor((l-20)/t)*t),0<p&&6>p?c.height()>m&&c.height(m):6<p&&c.height()>k&&c.height(k)))}e("div.jqselect").css({zIndex:f.singleSelectzIndex-1}).removeClass("opened focused");d.css({zIndex:f.singleSelectzIndex});
c.is(":hidden")?(e("div.jq-selectbox__dropdown:visible").hide(),c.show(),d.addClass("opened")):(c.hide(),d.removeClass("opened"));g.filter(".selected").length&&c.scrollTop(c.scrollTop()+g.filter(".selected").position().top-c.innerHeight()/2+t/2);s(c);y=c.height();g.children("."+x+"").focus();return!1}});g.hover(function(){e(this).siblings().removeClass("selected")});var A=g.filter(".selected").text();g.filter(".selected").text();g.filter(":not(.disabled):not(.optgroup):not(."+w+")").click(function(){var b=
e(this),l=b.text();if(A!=l){var g=f.selectSearch?b.index()-1:b.index();b.is(".option")&&(g-=b.prevAll(".optgroup").length);b.addClass("selected sel").siblings().removeClass("selected sel");h.prop("selected",!1).eq(g).prop("selected",!0);A=l;k.text(l);h.first().text()!=l?d.addClass("changed"):d.removeClass("changed");d.data("jqfs-class")&&d.removeClass(d.data("jqfs-class"));d.data("jqfs-class",b.data("jqfs-class"));d.addClass(b.data("jqfs-class"));a.change()}c.hide();d.removeClass("opened")});c.mouseout(function(){e("li.sel",
c).addClass("selected")});jQuery.expr[":"].contains=function(a,b,c,d){return 0<=(a.textContent||a.innerText||jQuery.text(a)||"").toLowerCase().indexOf(c[3].toLowerCase())};z.keyup(function(){g.show();e("#no_match").remove();c.height(y);var a=e(this).val();if(!1!=a){g.filter(":not(:contains('"+a+"')):not(."+w+")").hide();var a=g.filter(":contains('"+a+"')").size()+1,b=e("ul",d).innerHeight()+5;1==a&&(c.append('<li id="no_match" style="list-style-type: none">\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e</li>'),
a++,b=g.filter(":not(."+w+")").innerHeight()+g.innerHeight()+5);a<y/t&&c.height(b)}});a.change(function(){k.text(h.filter(":selected").text());g.removeClass("selected sel").not(".optgroup").eq(a[0].selectedIndex).addClass("selected sel")}).focus(function(){d.addClass("focused")}).blur(function(){d.removeClass("focused")}).bind("keydown keyup",function(b){k.text(h.filter(":selected").text());g.removeClass("selected sel").not(".optgroup").eq(a[0].selectedIndex).addClass("selected sel");38!=b.which&&
37!=b.which&&33!=b.which||c.scrollTop(c.scrollTop()+g.filter(".selected").position().top);40!=b.which&&39!=b.which&&34!=b.which||c.scrollTop(c.scrollTop()+g.filter(".selected").position().top-c.innerHeight()+t);13==b.which&&c.hide()});e(document).on("click",function(a){e(a.target).parents().hasClass("jq-selectbox")||"OPTION"==a.target.nodeName||(c.hide().find("li.sel").addClass("selected"),d.removeClass("focused opened"))})}function q(){var f=new r,d=e("<div"+f.id+' class="jq-select-multiple jqselect'+
f.classes+'"'+f.title+' style="display: inline-block; position: relative"></div>');a.css({margin:0,padding:0}).wrap('<div class="jq-selectbox-wrapper" style="display: inline-block; position: relative;"></div>').after(d);var f=a.clone().appendTo("body"),n=f.width();f.remove();n!=a.width()&&a.parent().css("display","block");b();d.append('<ul style="position: relative">'+v+"</ul>");var k=e("ul",d).css({"overflow-x":"hidden"}),c=e("li",d).attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none",
"-ms-user-select":"none","-o-user-select":"none","user-select":"none","white-space":"nowrap"}),f=a.attr("size"),n=k.outerHeight(),g=c.outerHeight();void 0!==f&&0<f?k.css({height:g*f}):k.css({height:4*g});n>d.height()&&(k.css("overflowY","scroll"),s(k),c.filter(".selected").length&&k.scrollTop(k.scrollTop()+c.filter(".selected").position().top));a.is(":disabled")?(d.addClass("disabled"),h.each(function(){e(this).is(":selected")&&c.eq(e(this).index()).addClass("selected")}),d.width(a.outerWidth()),
d.width(d.width()-(d.outerWidth()-d.width())),a.css({position:"absolute",opacity:0,height:d.outerHeight()})):(d.width(a.outerWidth()),d.width(d.width()-(d.outerWidth()-d.width())),a.css({position:"absolute",opacity:0,height:d.outerHeight()}),c.filter(":not(.disabled):not(.optgroup)").click(function(b){a.focus();d.removeClass("focused");var f=e(this);b.ctrlKey||f.addClass("selected");b.shiftKey||f.addClass("first");b.ctrlKey||b.shiftKey||f.siblings().removeClass("selected first");b.ctrlKey&&(f.is(".selected")?
f.removeClass("selected first"):f.addClass("selected first"),f.siblings().removeClass("first"));if(b.shiftKey){var g=!1,k=!1;f.siblings().removeClass("selected").siblings(".first").addClass("selected");f.prevAll().each(function(){e(this).is(".first")&&(g=!0)});f.nextAll().each(function(){e(this).is(".first")&&(k=!0)});g&&f.prevAll().each(function(){if(e(this).is(".selected"))return!1;e(this).not(".disabled, .optgroup").addClass("selected")});k&&f.nextAll().each(function(){if(e(this).is(".selected"))return!1;
e(this).not(".disabled, .optgroup").addClass("selected")});1==c.filter(".selected").length&&f.addClass("first")}h.prop("selected",!1);c.filter(".selected").each(function(){var a=e(this),b=a.index();a.is(".option")&&(b-=a.prevAll(".optgroup").length);h.eq(b).prop("selected",!0)});a.change()}),h.each(function(a){e(this).data("optionIndex",a)}),a.change(function(){c.removeClass("selected");var a=[];h.filter(":selected").each(function(){a.push(e(this).data("optionIndex"))});c.not(".optgroup").filter(function(b){return-1<
e.inArray(b,a)}).addClass("selected")}).focus(function(){d.addClass("focused")}).blur(function(){d.removeClass("focused")}),n>d.height()&&a.keydown(function(a){38!=a.which&&37!=a.which&&33!=a.which||k.scrollTop(k.scrollTop()+c.filter(".selected").position().top-g);40!=a.which&&39!=a.which&&34!=a.which||k.scrollTop(k.scrollTop()+c.filter(".selected:last").position().top-k.innerHeight()+2*g)}))}var h=e("option",a),v="";if(f.selectSearch)var w="li-search",x="input-search";a.is("[multiple]")?q():n()};
q();a.on("refresh",function(){a.parent().before(a).remove();q()});a.on("adaptiveWidth",function(){a.css({position:"static"});a.next().width(a.outerWidth());a.css({position:"absolute"})});e(window).on("resize",function(){a.trigger("adaptiveWidth")})}}):a.is(":reset")&&a.click(function(){setTimeout(function(){a.closest("form").find("input, select").trigger("refresh")},1)})})}})(jQuery);